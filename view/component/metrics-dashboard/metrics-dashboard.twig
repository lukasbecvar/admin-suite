{% extends 'common/layout.twig' %}

{% block component %}
{# SUB-NAVIGATION #}
<div class="bg-neutral-900 border-b border-neutral-700 sub-navigation breadcrumb">
    <a href={{ path('app_manager_logs') }} class="border border-gray-600 font-bold px-1 py-0 rounded mr-2 text-white" title="Back to log browser">
        <i class="fa fa-arrow-left" aria-hidden="true"></i>
    </a>
    <span class="mr-1 text-white">Metrics dashboard</span>
</div>

{# METRICS-CHARTS COMPONENT #}
<div class="p-2 space-y-2">
    {# CPU USAGE #}
    <div class="flex flex-col md:flex-row gap-2">
        <div class="flex-4 p-0 border border-gray-600 shadow-lg card-color rounded relative" style="min-height: 300px;">
            <div class="text-white font-bold text-l mb-1 border-b border-gray-600 p-2">
                CPU Usage (current)
            </div>
            <div id="cpu-usage-radial" style="width: 100%; height: 250px;"></div>
            <div id="cpu-usage-percentage" class="absolute text-white text-3xl font-bold" style="top: 45%; left: 50%; transform: translateX(-50%);">
                {{ data.cpu.current }}%
            </div>
        </div>

        <div class="flex-1 p-0 border border-gray-600 shadow-lg card-color rounded relative" style="height: 300px;">
            <div class="text-white font-bold text-l mb-1 border-b border-gray-600 p-2">
                CPU Usage (history)
            </div>
            <div id="cpu-usage-line" style="width: 100%; height: 100%;"></div>
        </div>
    </div>

    {# RAM USAGE #}
    <div class="flex flex-col md:flex-row gap-2">
        <div class="flex-4 p-0 border border-gray-600 shadow-lg card-color rounded relative" style="min-height: 300px;">
            <div class="text-white font-bold text-l mb-1 border-b border-gray-600 p-2">
                RAM Usage (current)
            </div>
            <div id="ram-usage-radial" style="width: 100%; height: 100%;"></div>
            <div id="ram-usage-percentage" class="absolute text-white text-3xl font-bold" style="top: 45%; left: 50%; transform: translateX(-50%);">
                {{ data.ram.current }}%
            </div>
        </div>
        <div class="flex-1 p-0 border border-gray-600 shadow-lg card-color rounded relative" style="height: 300px;">
            <div class="text-white font-bold text-l mb-1 border-b border-gray-600 p-2">
                RAM Usage (history)
            </div>
            <div id="ram-usage-line" style="width: 100%; height: 100%;"></div>
        </div>
    </div>

    {# STORAGE USAGE #}
    <div class="flex flex-col md:flex-row gap-2">
        <div class="flex-4 p-0 border border-gray-600 shadow-lg card-color rounded relative" style="min-height: 300px;">
            <div class="text-white font-bold text-l mb-1 border-b border-gray-600 p-2">
                Storage Usage (current)
            </div>
            <div id="storage-usage-radial" style="width: 100%; height: 100%;"></div>
            <div id="storage-usage-percentage" class="absolute text-white text-3xl font-bold" style="top: 45%; left: 50%; transform: translateX(-50%);">
                {{ data.storage.current }}%
            </div>
        </div>
        <div class="flex-1 p-0 border border-gray-600 shadow-lg card-color rounded relative" style="height: 300px;">
            <div class="text-white font-bold text-l mb-1 border-b border-gray-600 p-2">
                Storage Usage (history)
            </div>
            <div id="storage-usage-line" style="width: 100%; height: 100%;"></div>
        </div>
    </div>
</div>

{# GET METRICS DATA FORM CONTROLLER #}
<script>
    window.metricsData = {
        cpu: {
            current: {{ data.cpu.current }},
            data: {{ data.cpu.data|json_encode|raw }},
        },
        ram: {
            current: {{ data.ram.current }},
            data: {{ data.ram.data|json_encode|raw }},
        },
        storage: {
            current: {{ data.storage.current }},
            data: {{ data.storage.data|json_encode|raw }},
        },
        categories: {{ data.categories|json_encode|raw }},
    };
</script>

{# INCLUDE CHARTS SCRIPT #}
{{ encore_entry_script_tags('metrics-charts-js') }}

{% endblock %}
